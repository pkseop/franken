define(["jquery","view/"+$g.theme+"/pagemap.res.js","controller/PageController","sslplus.util"],function(e,t,n,r){var i=function(){var t=this,i=parseInt(e.browser.version,10);i===6&&(e.getScript("../lib/DD_belatedPNG.js"),e.getScript("../lib/json2.js"),e("body").addClass("ie6")),this.init=function(){function r(t){e("#area_id").addClass("error"),e("#area_id .help-block").text(t).fadeIn(),e("#txt_id").focus()}function i(r,i){n.resizeModal(250,parent),e("#area_input").fadeOut(),e("#area_msgbox").fadeIn(),t.initMsgbox(i,r)}e("#txt_id").on("keydown",function(t){t.keyCode==13?(t.stopPropagation(),t.preventDefault(),e("#btn_sendmail").click()):(e("#area_id").removeClass("error"),e("#area_id .help-block").hide())}),e("#btn_sendmail").on("click",function(t){t.stopPropagation(),t.preventDefault(),e("#txt_id").val()==""?r("아이디를 입력하세요"):e.post("/reset/sendmail",e("#sendmail").serialize()).success(function(t){try{var n=JSON.parse(t);n.result=="no_user"&&i(!0,"존재하지 않는 사용자 아이디입니다."),n.result=="null_login_name"?i(!0,"아이디를 입력하세요."):n.result=="no_config"?i(!0,"서버에서 메일을 보낼 수 없습니다. 관리자에게 문의하십시오."):n.result=="no_email"?i(!0,e("#txt_id").val()+"님의 이메일이 등록되지 않아서 인증 메일을 보낼 수 없습니다.<br/>관리자에게 문의하십시오."):n.result=="ok"&&i(!1,e("#txt_id").val()+"님의 암호를 재설정할 수 있는 링크를 이메일로 전송하였습니다.")}catch(r){i(!0,"서버에서 메일을 보낼 수 없습니다. (JSON error)")}}).error(function(e,t,n){i(!0,"서버에서 메일을 보낼 수 없습니다. 관리자에게 문의하십시오.<br/>"+e.status+" "+n)})})},this.initMsgbox=function(t,r){e("#msg").html(t),parent.log(t),e("#ok").on("click",function(e){e.preventDefault(),e.stopPropagation(),n.closeModal()});var i;r==1?i=e("<img>").attr("src","/view/common/image/remove.png").prependTo("#msg"):i=e("<img>").attr("src","/view/common/image/info.png").prependTo("#msg"),i.css("margin-right","15px")},this.initReset=function(){e("input[type=password]").on("keydown",function(t){e(this).parents(".control-group").removeClass("error"),e(this).next().text("")}),e("#do-reset").on("click",function(t){t.stopPropagation(),t.preventDefault();var n=e("#password_new").val(),i=e("#password_re").val();n==""?(e("#area_new .help-block").text("암호를 입력하세요").fadeIn(),e("#area_new").addClass("error"),e("#area_new input").focus()):i==""?(e("#area_re .help-block").text("암호를 입력하세요").fadeIn(),e("#area_re").addClass("error"),e("#area_re input").focus()):n!==i?(e("#area_re .help-block").text("두 암호가 서로 다릅니다.").fadeIn(),e("#area_re").addClass("error"),e("#area_re input").focus()):r.checkValidPassword(n)?e("#resetform").submit():(e("#area_new .help-block").text("암호는 9자 이상의 영문, 숫자, 특수문자 조합으로 만들어야 합니다.").fadeIn(),e("#area_new").addClass("error"),e("#area_new input").focus())})}};return new i})