define(["jquery","view/"+$g.theme+"/message.res.js"],function(e,t){var n=function(){var n=this,r={AXM_NOT_IMPLEMENTED:8001,AXM_NO_HOSTNAME:8002,AXM_VPN_SESSION_INIT_FAILED:8003,AXM_INTERNAL_ERROR:8004,AXM_LOGIN_USER_CANCELLED:8005,AXM_CONN_DISCONNECTED:8100,AXM_CONN_TERMINATED:8101,AXM_CONN_IDLETIME_EXPIRED:8102};this.AXM=r;var i=null,s;this.init=function(e,t){i=e,s=t},this.CancelLogin=function(){i.CancelLogin(),log("[CancelLogin]"),e(window).off(),o!=null&&(clearTimeout(o),o=null)},this.ActivexTrayEnabled=function(){i.ActivexTrayEnabled(),log("[ActivexTrayEnabled]")},this.Logout=function(){log("[Logout]"),n.CancelLogin(),s()},this.ConfirmLogout=function(){var e=confirm("정말 로그아웃 하시겠습니까?");e&&this.Logout()},this.RequestAuthMethod=function(t,n){var r=e.extend({success:function(e){},failed:function(e,t){log("[LoginHelper.RequestAuthMethod] failed, "+e+", "+t)}},n);log("[LoginHelper.RequestAuthMethod] request auth info"),setTimeout(function(){e.ajax("/external/authmethod?login_name="+t,{success:function(t){var n;log(t);try{n=JSON.parse(t)}catch(i){r.failed("error","invalid json")}r.success(n)},error:function(t,n,i){r.failed(n,i)}})},400)},this.RequestLogin=function(s,o,u,a,f){n.CancelLogin();var l=JSON.stringify(s);log("[SetAuthMethod]"),log(l);try{i.SetAuthMethod(l)}catch(c){a.setAuthMethodFailed();return}i.SetConnCallback(function(i,s,o){log("[RequestLogin] ConnCallback, "+i+", "+s+", "+o);if(i==r.AXM_CONN_DISCONNECTED)n.Logout();else if(i==r.AXM_CONN_TERMINATED){e(".modal").remove(),e(".modal-backdrop").remove();if(o==0)alert(t.ConnTerminatedForced);else if(o==2){alert(t.ConnTerminatedUnstable),n.CancelLogin(),location.reload();return}n.Logout()}}),log("[RequestLogin] "+s.auth_method+", "+o);var h=i.RequestLogin(s.auth_method,o,u,a,f);return h};var o;this.pollIdleTimeout=function(e,r){o!=null&&(clearTimeout(o),o=null);if(e===0)return;o=setInterval(function(){var s=i.getUserInputIdleTime();e<s&&(n.Logout(),alert(t.IdleTimeout));if(r!=null){var o=e-s;r(o)}},1e3)},this.savedPassword=function(e){if(!!window.__t3mpw0rd||!e){var t=parent.window.__t3mpw0rd;try{delete parent.window.__t3mpw0rd}catch(n){parent.window.__t3mpw0rd=undefined}return t}window.__t3mpw0rd=e}};return new n})